(statements (query (with (as "ssales") (query (select (ref "c_last_name") (ref "c_first_name") (ref "s_store_name") (ref "ca_state") (ref "s_state") (ref "i_color") (ref "i_current_price") (ref "i_manager_id") (ref "i_units") (ref "i_size") (as "netpaid") (function "sum" (ref "ss_sales_price"))) (from (join (join (join (join (join (table "store_sales") (table "store_returns")) (table "store")) (table "item")) (table "customer")) (table "customer_address"))) (where (and (and (and (and (and (and (and (equal (ref "ss_ticket_number") (ref "sr_ticket_number")) (equal (ref "ss_item_sk") (ref "sr_item_sk"))) (equal (ref "ss_customer_sk") (ref "c_customer_sk"))) (equal (ref "ss_item_sk") (ref "i_item_sk"))) (equal (ref "ss_store_sk") (ref "s_store_sk"))) (equal (ref "c_birth_country") (function "upper" (ref "ca_country")))) (equal (ref "s_zip") (ref "ca_zip"))) (equal (ref "s_market_id") 7))) (groupBy (ref "c_last_name") (ref "c_first_name") (ref "s_store_name") (ref "ca_state") (ref "s_state") (ref "i_color") (ref "i_current_price") (ref "i_manager_id") (ref "i_units") (ref "i_size")))) (select (ref "c_last_name") (ref "c_first_name") (ref "s_store_name") (as "paid") (function "sum" (ref "netpaid"))) (from (table "ssales")) (where (equal (ref "i_color") "chiffon")) (groupBy (ref "c_last_name") (ref "c_first_name") (ref "s_store_name")) (having (greater_than (function "sum" (ref "netpaid")) (query (select (multiply 0.050000 (function "avg" (ref "netpaid")))) (from (table "ssales")))))))
