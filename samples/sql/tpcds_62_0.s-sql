(statements (query (select (function "substr" (ref "w_warehouse_name") 1 20) (ref "sm_type") (ref "web_name") (as "30 days") (function "sum" (cases (case (when (less_than_or_equal (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 30)) (then 1)) (default 0))) (as "31-60 days") (function "sum" (cases (case (when (and (greater_than (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 30) (less_than_or_equal (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 60))) (then 1)) (default 0))) (as "61-90 days") (function "sum" (cases (case (when (and (greater_than (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 60) (less_than_or_equal (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 90))) (then 1)) (default 0))) (as "91-120 days") (function "sum" (cases (case (when (and (greater_than (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 90) (less_than_or_equal (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 120))) (then 1)) (default 0))) (as ">120 days") (function "sum" (cases (case (when (greater_than (subtract (ref "ws_ship_date_sk") (ref "ws_sold_date_sk")) 120)) (then 1)) (default 0)))) (from (join (join (join (join (table "web_sales") (table "warehouse")) (table "ship_mode")) (table "web_site")) (table "date_dim"))) (where (and (and (and (and (isBetween (ref "d_month_seq") 1212 (add 1212 11)) (equal (ref "ws_ship_date_sk") (ref "d_date_sk"))) (equal (ref "ws_warehouse_sk") (ref "w_warehouse_sk"))) (equal (ref "ws_ship_mode_sk") (ref "sm_ship_mode_sk"))) (equal (ref "ws_web_site_sk") (ref "web_site_sk")))) (groupBy (function "substr" (ref "w_warehouse_name") 1 20) (ref "sm_type") (ref "web_name")) (orderBy (ascending (function "substr" (ref "w_warehouse_name") 1 20)) (ascending (ref "sm_type")) (ascending (ref "web_name")))))
