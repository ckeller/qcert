(statements (query (with (as "ss_items") (query (select (as "item_id") (ref "i_item_id") (as "ss_item_rev") (function "sum" (ref "ss_ext_sales_price"))) (from (join (join (table "store_sales") (table "item")) (table "date_dim"))) (where (and (and (equal (ref "ss_item_sk") (ref "i_item_sk")) (isIn (ref "d_date") (query (select (ref "d_date")) (from (table "date_dim")) (where (equal (ref "d_week_seq") (query (select (ref "d_week_seq")) (from (table "date_dim")) (where (equal (ref "d_date") "1998-02-19")))))))) (equal (ref "ss_sold_date_sk") (ref "d_date_sk")))) (groupBy (ref "i_item_id")))) (with (as "cs_items") (query (select (as "item_id") (ref "i_item_id") (as "cs_item_rev") (function "sum" (ref "cs_ext_sales_price"))) (from (join (join (table "catalog_sales") (table "item")) (table "date_dim"))) (where (and (and (equal (ref "cs_item_sk") (ref "i_item_sk")) (isIn (ref "d_date") (query (select (ref "d_date")) (from (table "date_dim")) (where (equal (ref "d_week_seq") (query (select (ref "d_week_seq")) (from (table "date_dim")) (where (equal (ref "d_date") "1998-02-19")))))))) (equal (ref "cs_sold_date_sk") (ref "d_date_sk")))) (groupBy (ref "i_item_id")))) (with (as "ws_items") (query (select (as "item_id") (ref "i_item_id") (as "ws_item_rev") (function "sum" (ref "ws_ext_sales_price"))) (from (join (join (table "web_sales") (table "item")) (table "date_dim"))) (where (and (and (equal (ref "ws_item_sk") (ref "i_item_sk")) (isIn (ref "d_date") (query (select (ref "d_date")) (from (table "date_dim")) (where (equal (ref "d_week_seq") (query (select (ref "d_week_seq")) (from (table "date_dim")) (where (equal (ref "d_date") "1998-02-19")))))))) (equal (ref "ws_sold_date_sk") (ref "d_date_sk")))) (groupBy (ref "i_item_id")))) (select (deref "item_id" (ref "ss_items")) (ref "ss_item_rev") (as "ss_dev") (multiply (divide (ref "ss_item_rev") (divide (add (add (ref "ss_item_rev") (ref "cs_item_rev")) (ref "ws_item_rev")) 3)) 100) (ref "cs_item_rev") (as "cs_dev") (multiply (divide (ref "cs_item_rev") (divide (add (add (ref "ss_item_rev") (ref "cs_item_rev")) (ref "ws_item_rev")) 3)) 100) (ref "ws_item_rev") (as "ws_dev") (multiply (divide (ref "ws_item_rev") (divide (add (add (ref "ss_item_rev") (ref "cs_item_rev")) (ref "ws_item_rev")) 3)) 100) (as "average") (divide (add (add (ref "ss_item_rev") (ref "cs_item_rev")) (ref "ws_item_rev")) 3)) (from (join (join (table "ss_items") (table "cs_items")) (table "ws_items"))) (where (and (and (and (and (and (and (and (equal (deref "item_id" (ref "ss_items")) (deref "item_id" (ref "cs_items"))) (equal (deref "item_id" (ref "ss_items")) (deref "item_id" (ref "ws_items")))) (isBetween (ref "ss_item_rev") (multiply 0.900000 (ref "cs_item_rev")) (multiply 1.100000 (ref "cs_item_rev")))) (isBetween (ref "ss_item_rev") (multiply 0.900000 (ref "ws_item_rev")) (multiply 1.100000 (ref "ws_item_rev")))) (isBetween (ref "cs_item_rev") (multiply 0.900000 (ref "ss_item_rev")) (multiply 1.100000 (ref "ss_item_rev")))) (isBetween (ref "cs_item_rev") (multiply 0.900000 (ref "ws_item_rev")) (multiply 1.100000 (ref "ws_item_rev")))) (isBetween (ref "ws_item_rev") (multiply 0.900000 (ref "ss_item_rev")) (multiply 1.100000 (ref "ss_item_rev")))) (isBetween (ref "ws_item_rev") (multiply 0.900000 (ref "cs_item_rev")) (multiply 1.100000 (ref "cs_item_rev"))))) (orderBy (ascending (ref "item_id")) (ascending (ref "ss_item_rev")))))
