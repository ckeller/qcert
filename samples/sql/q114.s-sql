(statements (query (select (as "promo_revenue") (divide (multiply 100.000000 (function "sum" (cases (case (when (like (ref "p_type" ) "PROMO%" ) ) (then (multiply (ref "l_extendedprice" ) (subtract 1 (ref "l_discount" ) ) ) )) (default 0 )) ) ) (function "sum" (multiply (ref "l_extendedprice" ) (subtract 1 (ref "l_discount" ) ) ) ) ) ) (from (join (table "lineitem" ) (table "part" ) ) ) (where (and (and (equal (ref "l_partkey" ) (ref "p_partkey" ) ) (function "date_ge" (ref "l_shipdate" ) (literal "date" "1995-09-01" )) ) (function "date_lt" (ref "l_shipdate" ) (function "date_plus" (literal "date" "1995-09-01" )(interval "1" (month))) ) ) ) ) )
