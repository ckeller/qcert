(statements (query (select (all)) (from (aliasAs "dw2" (query (select (ref "i_category") (ref "i_class") (ref "i_brand") (ref "i_product_name") (ref "d_year") (ref "d_qoy") (ref "d_moy") (ref "s_store_id") (ref "sumsales") (as "rk") (function (orderBy (descending (ref "sumsales"))) (partitionBy (ref "i_category")) "rank")) (from (aliasAs "dw1" (query (select (ref "i_category") (ref "i_class") (ref "i_brand") (ref "i_product_name") (ref "d_year") (ref "d_qoy") (ref "d_moy") (ref "s_store_id") (as "sumsales") (function "sum" (coalesce (multiply (ref "ss_sales_price") (ref "ss_quantity")) 0))) (from (join (join (join (table "store_sales") (table "date_dim")) (table "store")) (table "item"))) (where (and (and (and (equal (ref "ss_sold_date_sk") (ref "d_date_sk")) (equal (ref "ss_item_sk") (ref "i_item_sk"))) (equal (ref "ss_store_sk") (ref "s_store_sk"))) (isBetween (ref "d_month_seq") 1212 (add 1212 11)))) (groupBy (rollup "i_category" "i_class" "i_brand" "i_product_name" "d_year" "d_qoy" "d_moy" "s_store_id")))))))) (where (less_than_or_equal (ref "rk") 100)) (orderBy (ascending (ref "i_category")) (ascending (ref "i_class")) (ascending (ref "i_brand")) (ascending (ref "i_product_name")) (ascending (ref "d_year")) (ascending (ref "d_qoy")) (ascending (ref "d_moy")) (ascending (ref "s_store_id")) (ascending (ref "sumsales")) (ascending (ref "rk")))))
