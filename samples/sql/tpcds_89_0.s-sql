(statements (query (select (all)) (from (aliasAs "tmp1" (query (select (ref "i_category") (ref "i_class") (ref "i_brand") (ref "s_store_name") (ref "s_company_name") (ref "d_moy") (as "sum_sales") (function "sum" (ref "ss_sales_price")) (as "avg_monthly_sales") (function (partitionBy (ref "i_category") (ref "i_brand") (ref "s_store_name") (ref "s_company_name")) "avg" (function "sum" (ref "ss_sales_price")))) (from (join (join (join (table "item") (table "store_sales")) (table "date_dim")) (table "store"))) (where (and (and (and (and (equal (ref "ss_item_sk") (ref "i_item_sk")) (equal (ref "ss_sold_date_sk") (ref "d_date_sk"))) (equal (ref "ss_store_sk") (ref "s_store_sk"))) (isIn (ref "d_year") (list 2000))) (or (and (isIn (ref "i_category") (list "Home" "Books" "Electronics")) (isIn (ref "i_class") (list "wallpaper" "parenting" "musical"))) (and (isIn (ref "i_category") (list "Shoes" "Jewelry" "Men")) (isIn (ref "i_class") (list "womens" "birdal" "pants")))))) (groupBy (ref "i_category") (ref "i_class") (ref "i_brand") (ref "s_store_name") (ref "s_company_name") (ref "d_moy"))))) (where (greater_than (cases (case (when (not_equal (ref "avg_monthly_sales") 0)) (then (divide (function "abs" (subtract (ref "sum_sales") (ref "avg_monthly_sales"))) (ref "avg_monthly_sales")))) (default (dunit))) 0.100000)) (orderBy (ascending (subtract (ref "sum_sales") (ref "avg_monthly_sales"))) (ascending (ref "s_store_name")))))
