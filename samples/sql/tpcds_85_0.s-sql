(statements (query (select (function "substr" (ref "r_reason_desc") 1 20) (function "avg" (ref "ws_quantity")) (function "avg" (ref "wr_refunded_cash")) (function "avg" (ref "wr_fee"))) (from (join (join (join (join (join (join (join (table "web_sales") (table "web_returns")) (table "web_page")) (aliasAs "cd1" (table "customer_demographics"))) (aliasAs "cd2" (table "customer_demographics"))) (table "customer_address")) (table "date_dim")) (table "reason"))) (where (and (and (and (and (and (and (and (and (and (and (equal (ref "ws_web_page_sk") (ref "wp_web_page_sk")) (equal (ref "ws_item_sk") (ref "wr_item_sk"))) (equal (ref "ws_order_number") (ref "wr_order_number"))) (equal (ref "ws_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1998)) (equal (deref "cd_demo_sk" (ref "cd1")) (ref "wr_refunded_cdemo_sk"))) (equal (deref "cd_demo_sk" (ref "cd2")) (ref "wr_returning_cdemo_sk"))) (equal (ref "ca_address_sk") (ref "wr_refunded_addr_sk"))) (equal (ref "r_reason_sk") (ref "wr_reason_sk"))) (or (or (and (and (and (and (equal (deref "cd_marital_status" (ref "cd1")) "M") (equal (deref "cd_marital_status" (ref "cd1")) (deref "cd_marital_status" (ref "cd2")))) (equal (deref "cd_education_status" (ref "cd1")) "4 yr Degree")) (equal (deref "cd_education_status" (ref "cd1")) (deref "cd_education_status" (ref "cd2")))) (isBetween (ref "ws_sales_price") 100 150)) (and (and (and (and (equal (deref "cd_marital_status" (ref "cd1")) "D") (equal (deref "cd_marital_status" (ref "cd1")) (deref "cd_marital_status" (ref "cd2")))) (equal (deref "cd_education_status" (ref "cd1")) "Primary")) (equal (deref "cd_education_status" (ref "cd1")) (deref "cd_education_status" (ref "cd2")))) (isBetween (ref "ws_sales_price") 50 100))) (and (and (and (and (equal (deref "cd_marital_status" (ref "cd1")) "U") (equal (deref "cd_marital_status" (ref "cd1")) (deref "cd_marital_status" (ref "cd2")))) (equal (deref "cd_education_status" (ref "cd1")) "Advanced Degree")) (equal (deref "cd_education_status" (ref "cd1")) (deref "cd_education_status" (ref "cd2")))) (isBetween (ref "ws_sales_price") 150 200)))) (or (or (and (and (equal (ref "ca_country") "United States") (isIn (ref "ca_state") (list "KY" "GA" "NM"))) (isBetween (ref "ws_net_profit") 100 200)) (and (and (equal (ref "ca_country") "United States") (isIn (ref "ca_state") (list "MT" "OR" "IN"))) (isBetween (ref "ws_net_profit") 150 300))) (and (and (equal (ref "ca_country") "United States") (isIn (ref "ca_state") (list "WI" "MO" "WV"))) (isBetween (ref "ws_net_profit") 50 250))))) (groupBy (ref "r_reason_desc")) (orderBy (ascending (function "substr" (ref "r_reason_desc") 1 20)) (ascending (function "avg" (ref "ws_quantity"))) (ascending (function "avg" (ref "wr_refunded_cash"))) (ascending (function "avg" (ref "wr_fee"))))))
