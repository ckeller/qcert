(statements (query (select (ref "w_warehouse_name") (ref "w_warehouse_sq_ft") (ref "w_city") (ref "w_county") (ref "w_state") (ref "w_country") (ref "ship_carriers") (ref "year") (as "jan_sales") (function "sum" (ref "jan_sales")) (as "feb_sales") (function "sum" (ref "feb_sales")) (as "mar_sales") (function "sum" (ref "mar_sales")) (as "apr_sales") (function "sum" (ref "apr_sales")) (as "may_sales") (function "sum" (ref "may_sales")) (as "jun_sales") (function "sum" (ref "jun_sales")) (as "jul_sales") (function "sum" (ref "jul_sales")) (as "aug_sales") (function "sum" (ref "aug_sales")) (as "sep_sales") (function "sum" (ref "sep_sales")) (as "oct_sales") (function "sum" (ref "oct_sales")) (as "nov_sales") (function "sum" (ref "nov_sales")) (as "dec_sales") (function "sum" (ref "dec_sales")) (as "jan_sales_per_sq_foot") (function "sum" (divide (ref "jan_sales") (ref "w_warehouse_sq_ft"))) (as "feb_sales_per_sq_foot") (function "sum" (divide (ref "feb_sales") (ref "w_warehouse_sq_ft"))) (as "mar_sales_per_sq_foot") (function "sum" (divide (ref "mar_sales") (ref "w_warehouse_sq_ft"))) (as "apr_sales_per_sq_foot") (function "sum" (divide (ref "apr_sales") (ref "w_warehouse_sq_ft"))) (as "may_sales_per_sq_foot") (function "sum" (divide (ref "may_sales") (ref "w_warehouse_sq_ft"))) (as "jun_sales_per_sq_foot") (function "sum" (divide (ref "jun_sales") (ref "w_warehouse_sq_ft"))) (as "jul_sales_per_sq_foot") (function "sum" (divide (ref "jul_sales") (ref "w_warehouse_sq_ft"))) (as "aug_sales_per_sq_foot") (function "sum" (divide (ref "aug_sales") (ref "w_warehouse_sq_ft"))) (as "sep_sales_per_sq_foot") (function "sum" (divide (ref "sep_sales") (ref "w_warehouse_sq_ft"))) (as "oct_sales_per_sq_foot") (function "sum" (divide (ref "oct_sales") (ref "w_warehouse_sq_ft"))) (as "nov_sales_per_sq_foot") (function "sum" (divide (ref "nov_sales") (ref "w_warehouse_sq_ft"))) (as "dec_sales_per_sq_foot") (function "sum" (divide (ref "dec_sales") (ref "w_warehouse_sq_ft"))) (as "jan_net") (function "sum" (ref "jan_net")) (as "feb_net") (function "sum" (ref "feb_net")) (as "mar_net") (function "sum" (ref "mar_net")) (as "apr_net") (function "sum" (ref "apr_net")) (as "may_net") (function "sum" (ref "may_net")) (as "jun_net") (function "sum" (ref "jun_net")) (as "jul_net") (function "sum" (ref "jul_net")) (as "aug_net") (function "sum" (ref "aug_net")) (as "sep_net") (function "sum" (ref "sep_net")) (as "oct_net") (function "sum" (ref "oct_net")) (as "nov_net") (function "sum" (ref "nov_net")) (as "dec_net") (function "sum" (ref "dec_net"))) (from (aliasAs "x" (query (union (query (select (ref "w_warehouse_name") (ref "w_warehouse_sq_ft") (ref "w_city") (ref "w_county") (ref "w_state") (ref "w_country") (as "ship_carriers") (function "concat" (function "concat" "DIAMOND" ",") "AIRBORNE") (as "year") (ref "d_year") (as "jan_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 1)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "feb_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 2)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "mar_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 3)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "apr_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 4)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "may_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 5)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "jun_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 6)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "jul_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 7)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "aug_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 8)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "sep_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 9)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "oct_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 10)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "nov_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 11)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "dec_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 12)) (then (multiply (ref "ws_sales_price") (ref "ws_quantity")))) (default 0))) (as "jan_net") (function "sum" (cases (case (when (equal (ref "d_moy") 1)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "feb_net") (function "sum" (cases (case (when (equal (ref "d_moy") 2)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "mar_net") (function "sum" (cases (case (when (equal (ref "d_moy") 3)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "apr_net") (function "sum" (cases (case (when (equal (ref "d_moy") 4)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "may_net") (function "sum" (cases (case (when (equal (ref "d_moy") 5)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "jun_net") (function "sum" (cases (case (when (equal (ref "d_moy") 6)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "jul_net") (function "sum" (cases (case (when (equal (ref "d_moy") 7)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "aug_net") (function "sum" (cases (case (when (equal (ref "d_moy") 8)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "sep_net") (function "sum" (cases (case (when (equal (ref "d_moy") 9)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "oct_net") (function "sum" (cases (case (when (equal (ref "d_moy") 10)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "nov_net") (function "sum" (cases (case (when (equal (ref "d_moy") 11)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0))) (as "dec_net") (function "sum" (cases (case (when (equal (ref "d_moy") 12)) (then (multiply (ref "ws_net_paid_inc_tax") (ref "ws_quantity")))) (default 0)))) (from (join (join (join (join (table "web_sales") (table "warehouse")) (table "date_dim")) (table "time_dim")) (table "ship_mode"))) (where (and (and (and (and (and (and (equal (ref "ws_warehouse_sk") (ref "w_warehouse_sk")) (equal (ref "ws_sold_date_sk") (ref "d_date_sk"))) (equal (ref "ws_sold_time_sk") (ref "t_time_sk"))) (equal (ref "ws_ship_mode_sk") (ref "sm_ship_mode_sk"))) (equal (ref "d_year") 2002)) (isBetween (ref "t_time") 49530 (add 49530 28800))) (isIn (ref "sm_carrier") (list "DIAMOND" "AIRBORNE")))) (groupBy (ref "w_warehouse_name") (ref "w_warehouse_sq_ft") (ref "w_city") (ref "w_county") (ref "w_state") (ref "w_country") (ref "d_year"))) (query (select (ref "w_warehouse_name") (ref "w_warehouse_sq_ft") (ref "w_city") (ref "w_county") (ref "w_state") (ref "w_country") (as "ship_carriers") (function "concat" (function "concat" "DIAMOND" ",") "AIRBORNE") (as "year") (ref "d_year") (as "jan_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 1)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "feb_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 2)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "mar_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 3)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "apr_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 4)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "may_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 5)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "jun_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 6)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "jul_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 7)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "aug_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 8)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "sep_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 9)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "oct_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 10)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "nov_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 11)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "dec_sales") (function "sum" (cases (case (when (equal (ref "d_moy") 12)) (then (multiply (ref "cs_ext_sales_price") (ref "cs_quantity")))) (default 0))) (as "jan_net") (function "sum" (cases (case (when (equal (ref "d_moy") 1)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "feb_net") (function "sum" (cases (case (when (equal (ref "d_moy") 2)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "mar_net") (function "sum" (cases (case (when (equal (ref "d_moy") 3)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "apr_net") (function "sum" (cases (case (when (equal (ref "d_moy") 4)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "may_net") (function "sum" (cases (case (when (equal (ref "d_moy") 5)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "jun_net") (function "sum" (cases (case (when (equal (ref "d_moy") 6)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "jul_net") (function "sum" (cases (case (when (equal (ref "d_moy") 7)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "aug_net") (function "sum" (cases (case (when (equal (ref "d_moy") 8)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "sep_net") (function "sum" (cases (case (when (equal (ref "d_moy") 9)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "oct_net") (function "sum" (cases (case (when (equal (ref "d_moy") 10)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "nov_net") (function "sum" (cases (case (when (equal (ref "d_moy") 11)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0))) (as "dec_net") (function "sum" (cases (case (when (equal (ref "d_moy") 12)) (then (multiply (ref "cs_net_paid_inc_ship_tax") (ref "cs_quantity")))) (default 0)))) (from (join (join (join (join (table "catalog_sales") (table "warehouse")) (table "date_dim")) (table "time_dim")) (table "ship_mode"))) (where (and (and (and (and (and (and (equal (ref "cs_warehouse_sk") (ref "w_warehouse_sk")) (equal (ref "cs_sold_date_sk") (ref "d_date_sk"))) (equal (ref "cs_sold_time_sk") (ref "t_time_sk"))) (equal (ref "cs_ship_mode_sk") (ref "sm_ship_mode_sk"))) (equal (ref "d_year") 2002)) (isBetween (ref "t_time") 49530 (add 49530 28800))) (isIn (ref "sm_carrier") (list "DIAMOND" "AIRBORNE")))) (groupBy (ref "w_warehouse_name") (ref "w_warehouse_sq_ft") (ref "w_city") (ref "w_county") (ref "w_state") (ref "w_country") (ref "d_year"))))))) (groupBy (ref "w_warehouse_name") (ref "w_warehouse_sq_ft") (ref "w_city") (ref "w_county") (ref "w_state") (ref "w_country") (ref "ship_carriers") (ref "year")) (orderBy (ascending (ref "w_warehouse_name")))))
