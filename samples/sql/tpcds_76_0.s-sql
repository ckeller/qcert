(statements (query (select (ref "channel") (ref "col_name") (ref "d_year") (ref "d_qoy") (ref "i_category") (as "sales_cnt") (function "count") (as "sales_amt") (function "sum" (ref "ext_sales_price"))) (from (aliasAs "foo" (query (union (union (query (select (as "channel") "store" (as "col_name") "ss_addr_sk" (ref "d_year") (ref "d_qoy") (ref "i_category") (as "ext_sales_price") (ref "ss_ext_sales_price")) (from (join (join (table "store_sales") (table "item")) (table "date_dim"))) (where (and (and (isNull (ref "ss_addr_sk")) (equal (ref "ss_sold_date_sk") (ref "d_date_sk"))) (equal (ref "ss_item_sk") (ref "i_item_sk"))))) (query (select (as "channel") "web" (as "col_name") "ws_web_page_sk" (ref "d_year") (ref "d_qoy") (ref "i_category") (as "ext_sales_price") (ref "ws_ext_sales_price")) (from (join (join (table "web_sales") (table "item")) (table "date_dim"))) (where (and (and (isNull (ref "ws_web_page_sk")) (equal (ref "ws_sold_date_sk") (ref "d_date_sk"))) (equal (ref "ws_item_sk") (ref "i_item_sk")))))) (query (select (as "channel") "catalog" (as "col_name") "cs_warehouse_sk" (ref "d_year") (ref "d_qoy") (ref "i_category") (as "ext_sales_price") (ref "cs_ext_sales_price")) (from (join (join (table "catalog_sales") (table "item")) (table "date_dim"))) (where (and (and (isNull (ref "cs_warehouse_sk")) (equal (ref "cs_sold_date_sk") (ref "d_date_sk"))) (equal (ref "cs_item_sk") (ref "i_item_sk"))))))))) (groupBy (ref "channel") (ref "col_name") (ref "d_year") (ref "d_qoy") (ref "i_category")) (orderBy (ascending (ref "channel")) (ascending (ref "col_name")) (ascending (ref "d_year")) (ascending (ref "d_qoy")) (ascending (ref "i_category")))))
