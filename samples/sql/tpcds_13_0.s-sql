(statements (query (select (function "avg" (ref "ss_quantity")) (function "avg" (ref "ss_ext_sales_price")) (function "avg" (ref "ss_ext_wholesale_cost")) (function "sum" (ref "ss_ext_wholesale_cost"))) (from (join (join (join (join (join (table "store_sales") (table "store")) (table "customer_demographics")) (table "household_demographics")) (table "customer_address")) (table "date_dim"))) (where (and (and (and (and (equal (ref "s_store_sk") (ref "ss_store_sk")) (equal (ref "ss_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 2001)) (or (or (and (and (and (and (and (equal (ref "ss_hdemo_sk") (ref "hd_demo_sk")) (equal (ref "cd_demo_sk") (ref "ss_cdemo_sk"))) (equal (ref "cd_marital_status") "D")) (equal (ref "cd_education_status") "2 yr Degree")) (isBetween (ref "ss_sales_price") 100 150)) (equal (ref "hd_dep_count") 3)) (and (and (and (and (and (equal (ref "ss_hdemo_sk") (ref "hd_demo_sk")) (equal (ref "cd_demo_sk") (ref "ss_cdemo_sk"))) (equal (ref "cd_marital_status") "S")) (equal (ref "cd_education_status") "Secondary")) (isBetween (ref "ss_sales_price") 50 100)) (equal (ref "hd_dep_count") 1))) (and (and (and (and (and (equal (ref "ss_hdemo_sk") (ref "hd_demo_sk")) (equal (ref "cd_demo_sk") (ref "ss_cdemo_sk"))) (equal (ref "cd_marital_status") "W")) (equal (ref "cd_education_status") "Advanced Degree")) (isBetween (ref "ss_sales_price") 150 200)) (equal (ref "hd_dep_count") 1)))) (or (or (and (and (and (equal (ref "ss_addr_sk") (ref "ca_address_sk")) (equal (ref "ca_country") "United States")) (isIn (ref "ca_state") (list "CO" "IL" "MN"))) (isBetween (ref "ss_net_profit") 100 200)) (and (and (and (equal (ref "ss_addr_sk") (ref "ca_address_sk")) (equal (ref "ca_country") "United States")) (isIn (ref "ca_state") (list "OH" "MT" "NM"))) (isBetween (ref "ss_net_profit") 150 300))) (and (and (and (equal (ref "ss_addr_sk") (ref "ca_address_sk")) (equal (ref "ca_country") "United States")) (isIn (ref "ca_state") (list "TX" "MO" "MI"))) (isBetween (ref "ss_net_profit") 50 250)))))))
