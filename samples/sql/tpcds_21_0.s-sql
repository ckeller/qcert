(statements (query (select (all)) (from (aliasAs "x" (query (select (ref "w_warehouse_name") (ref "i_item_id") (as "inv_before") (function "sum" (cases (case (when (less_than (cast (as "DATE") (ref "d_date")) (cast (as "DATE") "1998-04-08"))) (then (ref "inv_quantity_on_hand"))) (default 0))) (as "inv_after") (function "sum" (cases (case (when (greater_than_or_equal (cast (as "DATE") (ref "d_date")) (cast (as "DATE") "1998-04-08"))) (then (ref "inv_quantity_on_hand"))) (default 0)))) (from (join (join (join (table "inventory") (table "warehouse")) (table "item")) (table "date_dim"))) (where (and (and (and (and (isBetween (ref "i_current_price") 0.990000 1.490000) (equal (ref "i_item_sk") (ref "inv_item_sk"))) (equal (ref "inv_warehouse_sk") (ref "w_warehouse_sk"))) (equal (ref "inv_date_sk") (ref "d_date_sk"))) (isBetween (ref "d_date") (subtract (cast (as "DATE") "1998-04-08") (interval "30" (day))) (add (cast (as "DATE") "1998-04-08") (interval "30" (day)))))) (groupBy (ref "w_warehouse_name") (ref "i_item_id"))))) (where (isBetween (cases (case (when (greater_than (ref "inv_before") 0)) (then (divide (ref "inv_after") (ref "inv_before")))) (default (dunit))) (divide 2 3) (divide 3 2))) (orderBy (ascending (ref "w_warehouse_name")) (ascending (ref "i_item_id")))))
