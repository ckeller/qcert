(query (select (ref "supp_nation" ) (ref "cust_nation" ) (ref "l_year" ) (as "revenue") (function "sum" (ref "volume" ) ) ) (from (aliasAs "shipping" (query (select (as "supp_nation") (deref "n_name" (ref "n1" ) ) (as "cust_nation") (deref "n_name" (ref "n2" ) ) (as "l_year") (extract (year) (ref "l_shipdate" ) ) (as "volume") (multiply (ref "l_extendedprice" ) (subtract 1 (ref "l_discount" ) ) ) ) (from (join (join (join (join (join (table "supplier" ) (table "lineitem" ) ) (table "orders" ) ) (table "customer" ) ) (aliasAs "n1" (table "nation" ) ) ) (aliasAs "n2" (table "nation" ) ) ) ) (where (and (and (and (and (and (and (equal (ref "s_suppkey" ) (ref "l_suppkey" ) ) (equal (ref "o_orderkey" ) (ref "l_orderkey" ) ) ) (equal (ref "c_custkey" ) (ref "o_custkey" ) ) ) (equal (ref "s_nationkey" ) (deref "n_nationkey" (ref "n1" ) ) ) ) (equal (ref "c_nationkey" ) (deref "n_nationkey" (ref "n2" ) ) ) ) (or (and (equal (deref "n_name" (ref "n1" ) ) "FRANCE" ) (equal (deref "n_name" (ref "n2" ) ) "GERMANY" ) ) (and (equal (deref "n_name" (ref "n1" ) ) "GERMANY" ) (equal (deref "n_name" (ref "n2" ) ) "FRANCE" ) ) ) ) (function "date_bewteen" (ref "l_shipdate" ) (literal "date" "1995-01-01" )(literal "date" "1996-12-31" )) ) ) ) ) ) (groupBy (ref "supp_nation" ) (ref "cust_nation" ) (ref "l_year" ) ) (orderBy (ascending (ref "supp_nation" ) ) (ascending (ref "cust_nation" ) ) (ascending (ref "l_year" ) ) ) ) 
