(statements (query (select (as "Excess Discount Amount") (function "sum" (ref "ws_ext_discount_amt"))) (from (join (join (table "web_sales") (table "item")) (table "date_dim"))) (where (and (and (and (and (equal (ref "i_manufact_id") 269) (equal (ref "i_item_sk") (ref "ws_item_sk"))) (isBetween (ref "d_date") "1998-03-18" (add (cast (as "DATE") "1998-03-18") (interval "90" (day))))) (equal (ref "d_date_sk") (ref "ws_sold_date_sk"))) (greater_than (ref "ws_ext_discount_amt") (query (select (multiply 1.300000 (function "avg" (ref "ws_ext_discount_amt")))) (from (join (table "web_sales") (table "date_dim"))) (where (and (and (equal (ref "ws_item_sk") (ref "i_item_sk")) (isBetween (ref "d_date") "1998-03-18" (add (cast (as "DATE") "1998-03-18") (interval "90" (day))))) (equal (ref "d_date_sk") (ref "ws_sold_date_sk")))))))) (orderBy (ascending (function "sum" (ref "ws_ext_discount_amt"))))))
