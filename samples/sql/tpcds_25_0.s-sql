(statements (query (select (ref "i_item_id") (ref "i_item_desc") (ref "s_store_id") (ref "s_store_name") (as "store_sales_profit") (function "sum" (ref "ss_net_profit")) (as "store_returns_loss") (function "sum" (ref "sr_net_loss")) (as "catalog_sales_profit") (function "sum" (ref "cs_net_profit"))) (from (join (join (join (join (join (join (join (table "store_sales") (table "store_returns")) (table "catalog_sales")) (aliasAs "d1" (table "date_dim"))) (aliasAs "d2" (table "date_dim"))) (aliasAs "d3" (table "date_dim"))) (table "store")) (table "item"))) (where (and (and (and (and (and (and (and (and (and (and (and (and (and (and (and (equal (deref "d_moy" (ref "d1")) 4) (equal (deref "d_year" (ref "d1")) 2000)) (equal (deref "d_date_sk" (ref "d1")) (ref "ss_sold_date_sk"))) (equal (ref "i_item_sk") (ref "ss_item_sk"))) (equal (ref "s_store_sk") (ref "ss_store_sk"))) (equal (ref "ss_customer_sk") (ref "sr_customer_sk"))) (equal (ref "ss_item_sk") (ref "sr_item_sk"))) (equal (ref "ss_ticket_number") (ref "sr_ticket_number"))) (equal (ref "sr_returned_date_sk") (deref "d_date_sk" (ref "d2")))) (isBetween (deref "d_moy" (ref "d2")) 4 10)) (equal (deref "d_year" (ref "d2")) 2000)) (equal (ref "sr_customer_sk") (ref "cs_bill_customer_sk"))) (equal (ref "sr_item_sk") (ref "cs_item_sk"))) (equal (ref "cs_sold_date_sk") (deref "d_date_sk" (ref "d3")))) (isBetween (deref "d_moy" (ref "d3")) 4 10)) (equal (deref "d_year" (ref "d3")) 2000))) (groupBy (ref "i_item_id") (ref "i_item_desc") (ref "s_store_id") (ref "s_store_name")) (orderBy (ascending (ref "i_item_id")) (ascending (ref "i_item_desc")) (ascending (ref "s_store_id")) (ascending (ref "s_store_name")))))
