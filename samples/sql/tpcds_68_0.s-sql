(statements (query (select (ref "c_last_name") (ref "c_first_name") (ref "ca_city") (ref "bought_city") (ref "ss_ticket_number") (ref "extended_price") (ref "extended_tax") (ref "list_price")) (from (join (join (aliasAs "dn" (query (select (ref "ss_ticket_number") (ref "ss_customer_sk") (as "bought_city") (ref "ca_city") (as "extended_price") (function "sum" (ref "ss_ext_sales_price")) (as "list_price") (function "sum" (ref "ss_ext_list_price")) (as "extended_tax") (function "sum" (ref "ss_ext_tax"))) (from (join (join (join (join (table "store_sales") (table "date_dim")) (table "store")) (table "household_demographics")) (table "customer_address"))) (where (and (and (and (and (and (and (and (equal (deref "ss_sold_date_sk" (ref "store_sales")) (deref "d_date_sk" (ref "date_dim"))) (equal (deref "ss_store_sk" (ref "store_sales")) (deref "s_store_sk" (ref "store")))) (equal (deref "ss_hdemo_sk" (ref "store_sales")) (deref "hd_demo_sk" (ref "household_demographics")))) (equal (deref "ss_addr_sk" (ref "store_sales")) (deref "ca_address_sk" (ref "customer_address")))) (isBetween (deref "d_dom" (ref "date_dim")) 1 2)) (or (equal (deref "hd_dep_count" (ref "household_demographics")) 5) (equal (deref "hd_vehicle_count" (ref "household_demographics")) 3))) (isIn (deref "d_year" (ref "date_dim")) (list 1999 (add 1999 1) (add 1999 2)))) (isIn (deref "s_city" (ref "store")) (list "Midway" "Fairview")))) (groupBy (ref "ss_ticket_number") (ref "ss_customer_sk") (ref "ss_addr_sk") (ref "ca_city")))) (table "customer")) (aliasAs "current_addr" (table "customer_address")))) (where (and (and (equal (ref "ss_customer_sk") (ref "c_customer_sk")) (equal (deref "c_current_addr_sk" (ref "customer")) (deref "ca_address_sk" (ref "current_addr")))) (not_equal (deref "ca_city" (ref "current_addr")) (ref "bought_city")))) (orderBy (ascending (ref "c_last_name")) (ascending (ref "ss_ticket_number")))))
