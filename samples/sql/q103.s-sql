(query (select (ref "l_orderkey" ) (as "revenue") (function "sum" (multiply (ref "l_extendedprice" ) (subtract 1 (ref "l_discount" ) ) ) ) (ref "o_orderdate" ) (ref "o_shippriority" ) ) (from (join (join (table "customer" ) (table "orders" ) ) (table "lineitem" ) ) ) (where (and (and (and (and (equal (ref "c_mktsegment" ) "BUILDING" ) (equal (ref "c_custkey" ) (ref "o_custkey" ) ) ) (equal (ref "l_orderkey" ) (ref "o_orderkey" ) ) ) (function "date_lt" (ref "o_orderdate" ) (literal "date" "1995-03-15" )) ) (function "date_lt" (ref "l_shipdate" ) (literal "date" "1995-03-15" )) ) ) (groupBy (ref "l_orderkey" ) (ref "o_orderdate" ) (ref "o_shippriority" ) ) (orderBy (descending (ref "revenue" ) ) (ascending (ref "o_orderdate" ) ) ) ) 
