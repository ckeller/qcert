(query (select (ref "c_name") (ref "c_custkey") (ref "o_orderkey") (ref "o_orderdate") (ref "o_totalprice") (function "sum" (ref "l_quantity"))) (from (join (join (table "customer") (table "orders")) (table "lineitem"))) (where (and (and (isIn (ref "o_orderkey") (query (select (ref "l_orderkey")) (from (table "lineitem")) (groupBy (ref "l_orderkey")) (having (greater_than (function "sum" (ref "l_quantity")) 300.000000)))) (equal (ref "c_custkey") (ref "o_custkey"))) (equal (ref "o_orderkey") (ref "l_orderkey")))) (groupBy (ref "c_name") (ref "c_custkey") (ref "o_orderkey") (ref "o_orderdate") (ref "o_totalprice")) (orderBy (descending (ref "o_totalprice")) (ascending (ref "o_orderdate"))))
