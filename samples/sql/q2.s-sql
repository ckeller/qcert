(query (select (ref "s_acctbal" ) (ref "s_name" ) (ref "n_name" ) (ref "p_partkey" ) (ref "p_mfgr" ) (ref "s_address" ) (ref "s_phone" ) (ref "s_comment" ) ) (from (join (join (join (join (table "part" ) (table "supplier" ) ) (table "partsupp" ) ) (table "nation" ) ) (table "region" ) ) ) (where (and (and (and (and (and (and (and (equal (ref "p_partkey" ) (ref "ps_partkey" ) ) (equal (ref "s_suppkey" ) (ref "ps_suppkey" ) ) ) (equal (ref "p_size" ) 15 ) ) (like (ref "p_type" ) "%BRASS" ) ) (equal (ref "s_nationkey" ) (ref "n_nationkey" ) ) ) (equal (ref "n_regionkey" ) (ref "r_regionkey" ) ) ) (equal (ref "r_name" ) "EUROPE" ) ) (equal (ref "ps_supplycost" ) (query (select (function "min" (ref "ps_supplycost" ) ) ) (from (join (join (join (table "partsupp" ) (table "supplier" ) ) (table "nation" ) ) (table "region" ) ) ) (where (and (and (and (and (equal (ref "p_partkey" ) (ref "ps_partkey" ) ) (equal (ref "s_suppkey" ) (ref "ps_suppkey" ) ) ) (equal (ref "s_nationkey" ) (ref "n_nationkey" ) ) ) (equal (ref "n_regionkey" ) (ref "r_regionkey" ) ) ) (equal (ref "r_name" ) "EUROPE" ) ) ) ) ) ) ) (orderBy (descending (ref "s_acctbal" ) ) (ascending (ref "n_name" ) ) (ascending (ref "s_name" ) ) (ascending (ref "p_partkey" ) ) ) ) 
