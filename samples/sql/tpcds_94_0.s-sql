(statements (query (select (as "order count") (function "count" (ref "ws_order_number")) (as "total shipping cost") (function "sum" (ref "ws_ext_ship_cost")) (as "total net profit") (function "sum" (ref "ws_net_profit"))) (from (join (join (join (aliasAs "ws1" (table "web_sales")) (table "date_dim")) (table "customer_address")) (table "web_site"))) (where (and (and (and (and (and (and (and (isBetween (ref "d_date") "1999-5-01" (add (cast (as "DATE") "1999-5-01") (interval "60" (day)))) (equal (deref "ws_ship_date_sk" (ref "ws1")) (ref "d_date_sk"))) (equal (deref "ws_ship_addr_sk" (ref "ws1")) (ref "ca_address_sk"))) (equal (ref "ca_state") "TX")) (equal (deref "ws_web_site_sk" (ref "ws1")) (ref "web_site_sk"))) (equal (ref "web_company_name") "pri")) (exists (query (select (all)) (from (aliasAs "ws2" (table "web_sales"))) (where (and (equal (deref "ws_order_number" (ref "ws1")) (deref "ws_order_number" (ref "ws2"))) (not_equal (deref "ws_warehouse_sk" (ref "ws1")) (deref "ws_warehouse_sk" (ref "ws2")))))))) (not (exists (query (select (all)) (from (aliasAs "wr1" (table "web_returns"))) (where (equal (deref "ws_order_number" (ref "ws1")) (deref "wr_order_number" (ref "wr1"))))))))) (orderBy (ascending (function "count" (ref "ws_order_number"))))))
