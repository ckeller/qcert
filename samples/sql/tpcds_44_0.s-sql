(statements (query (select (deref "rnk" (ref "asceding")) (as "best_performing") (deref "i_product_name" (ref "i1")) (as "worst_performing") (deref "i_product_name" (ref "i2"))) (from (join (join (join (aliasAs "asceding" (query (select (all)) (from (aliasAs "V11" (query (select (ref "item_sk") (as "rnk") (function (orderBy (ascending (ref "rank_col"))) "rank")) (from (aliasAs "V1" (query (select (as "item_sk") (ref "ss_item_sk") (as "rank_col") (function "avg" (ref "ss_net_profit"))) (from (aliasAs "ss1" (table "store_sales"))) (where (equal (ref "ss_store_sk") 2)) (groupBy (ref "ss_item_sk")) (having (greater_than (function "avg" (ref "ss_net_profit")) (multiply 0.900000 (query (select (as "rank_col") (function "avg" (ref "ss_net_profit"))) (from (table "store_sales")) (where (and (equal (ref "ss_store_sk") 2) (isNull (ref "ss_hdemo_sk")))) (groupBy (ref "ss_store_sk")))))))))))) (where (less_than (ref "rnk") 11)))) (aliasAs "descending" (query (select (all)) (from (aliasAs "V21" (query (select (ref "item_sk") (as "rnk") (function (orderBy (descending (ref "rank_col"))) "rank")) (from (aliasAs "V2" (query (select (as "item_sk") (ref "ss_item_sk") (as "rank_col") (function "avg" (ref "ss_net_profit"))) (from (aliasAs "ss1" (table "store_sales"))) (where (equal (ref "ss_store_sk") 2)) (groupBy (ref "ss_item_sk")) (having (greater_than (function "avg" (ref "ss_net_profit")) (multiply 0.900000 (query (select (as "rank_col") (function "avg" (ref "ss_net_profit"))) (from (table "store_sales")) (where (and (equal (ref "ss_store_sk") 2) (isNull (ref "ss_hdemo_sk")))) (groupBy (ref "ss_store_sk")))))))))))) (where (less_than (ref "rnk") 11))))) (aliasAs "i1" (table "item"))) (aliasAs "i2" (table "item")))) (where (and (and (equal (deref "rnk" (ref "asceding")) (deref "rnk" (ref "descending"))) (equal (deref "i_item_sk" (ref "i1")) (deref "item_sk" (ref "asceding")))) (equal (deref "i_item_sk" (ref "i2")) (deref "item_sk" (ref "descending"))))) (orderBy (ascending (deref "rnk" (ref "asceding"))))))
