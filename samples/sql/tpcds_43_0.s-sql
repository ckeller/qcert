(statements (query (select (ref "s_store_name") (ref "s_store_id") (as "sun_sales") (function "sum" (cases (case (when (equal (ref "d_day_name") "Sunday")) (then (ref "ss_sales_price"))) (default (dunit)))) (as "mon_sales") (function "sum" (cases (case (when (equal (ref "d_day_name") "Monday")) (then (ref "ss_sales_price"))) (default (dunit)))) (as "tue_sales") (function "sum" (cases (case (when (equal (ref "d_day_name") "Tuesday")) (then (ref "ss_sales_price"))) (default (dunit)))) (as "wed_sales") (function "sum" (cases (case (when (equal (ref "d_day_name") "Wednesday")) (then (ref "ss_sales_price"))) (default (dunit)))) (as "thu_sales") (function "sum" (cases (case (when (equal (ref "d_day_name") "Thursday")) (then (ref "ss_sales_price"))) (default (dunit)))) (as "fri_sales") (function "sum" (cases (case (when (equal (ref "d_day_name") "Friday")) (then (ref "ss_sales_price"))) (default (dunit)))) (as "sat_sales") (function "sum" (cases (case (when (equal (ref "d_day_name") "Saturday")) (then (ref "ss_sales_price"))) (default (dunit))))) (from (join (join (table "date_dim") (table "store_sales")) (table "store"))) (where (and (and (and (equal (ref "d_date_sk") (ref "ss_sold_date_sk")) (equal (ref "s_store_sk") (ref "ss_store_sk"))) (equal (ref "s_gmt_offset") (minus 5))) (equal (ref "d_year") 1998))) (groupBy (ref "s_store_name") (ref "s_store_id")) (orderBy (ascending (ref "s_store_name")) (ascending (ref "s_store_id")) (ascending (ref "sun_sales")) (ascending (ref "mon_sales")) (ascending (ref "tue_sales")) (ascending (ref "wed_sales")) (ascending (ref "thu_sales")) (ascending (ref "fri_sales")) (ascending (ref "sat_sales")))))
