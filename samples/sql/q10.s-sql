(query (select (ref "c_custkey") (ref "c_name") (as "revenue") (function "sum" (multiply (ref "l_extendedprice") (subtract 1.000000 (ref "l_discount")))) (ref "c_acctbal") (ref "n_name") (ref "c_address") (ref "c_phone") (ref "c_comment")) (from (join (join (join (table "customer") (table "orders")) (table "lineitem")) (table "nation"))) (where (and (and (and (and (and (equal (ref "c_custkey") (ref "o_custkey")) (equal (ref "l_orderkey") (ref "o_orderkey"))) (greater_than_or_equal (ref "o_orderdate") (literal "date" "1993-10-01"))) (less_than (ref "o_orderdate") (add (literal "date" "1993-10-01") (interval "3" (month))))) (equal (ref "l_returnflag") "R")) (equal (ref "c_nationkey") (ref "n_nationkey")))) (groupBy (ref "c_custkey") (ref "c_name") (ref "c_acctbal") (ref "c_phone") (ref "n_name") (ref "c_address") (ref "c_comment")) (orderBy (descending (ref "revenue"))))
