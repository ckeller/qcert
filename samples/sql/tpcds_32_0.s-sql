(statements (query (select (as "excess discount amount") (function "sum" (ref "cs_ext_discount_amt"))) (from (join (join (table "catalog_sales") (table "item")) (table "date_dim"))) (where (and (and (and (and (equal (ref "i_manufact_id") 269) (equal (ref "i_item_sk") (ref "cs_item_sk"))) (isBetween (ref "d_date") "1998-03-18" (add (cast (as "DATE") "1998-03-18") (interval "90" (day))))) (equal (ref "d_date_sk") (ref "cs_sold_date_sk"))) (greater_than (ref "cs_ext_discount_amt") (query (select (multiply 1.300000 (function "avg" (ref "cs_ext_discount_amt")))) (from (join (table "catalog_sales") (table "date_dim"))) (where (and (and (equal (ref "cs_item_sk") (ref "i_item_sk")) (isBetween (ref "d_date") "1998-03-18" (add (cast (as "DATE") "1998-03-18") (interval "90" (day))))) (equal (ref "d_date_sk") (ref "cs_sold_date_sk"))))))))))
