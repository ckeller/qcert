(statements (query (select (ref "i_item_id") (as "agg1") (function "avg" (ref "cs_quantity")) (as "agg2") (function "avg" (ref "cs_list_price")) (as "agg3") (function "avg" (ref "cs_coupon_amt")) (as "agg4") (function "avg" (ref "cs_sales_price"))) (from (join (join (join (join (table "catalog_sales") (table "customer_demographics")) (table "date_dim")) (table "item")) (table "promotion"))) (where (and (and (and (and (and (and (and (and (equal (ref "cs_sold_date_sk") (ref "d_date_sk")) (equal (ref "cs_item_sk") (ref "i_item_sk"))) (equal (ref "cs_bill_cdemo_sk") (ref "cd_demo_sk"))) (equal (ref "cs_promo_sk") (ref "p_promo_sk"))) (equal (ref "cd_gender") "F")) (equal (ref "cd_marital_status") "W")) (equal (ref "cd_education_status") "Primary")) (or (equal (ref "p_channel_email") "N") (equal (ref "p_channel_event") "N"))) (equal (ref "d_year") 1998))) (groupBy (ref "i_item_id")) (orderBy (ascending (ref "i_item_id")))))
