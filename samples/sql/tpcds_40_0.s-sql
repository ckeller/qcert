(statements (query (select (ref "w_state") (ref "i_item_id") (as "sales_before") (function "sum" (cases (case (when (less_than (cast (as "DATE") (ref "d_date")) (cast (as "DATE") "1998-04-08"))) (then (subtract (ref "cs_sales_price") (coalesce (ref "cr_refunded_cash") 0)))) (default 0))) (as "sales_after") (function "sum" (cases (case (when (greater_than_or_equal (cast (as "DATE") (ref "d_date")) (cast (as "DATE") "1998-04-08"))) (then (subtract (ref "cs_sales_price") (coalesce (ref "cr_refunded_cash") 0)))) (default 0)))) (from (join (join (join (join (left) (on (and (equal (ref "cs_order_number") (ref "cr_order_number")) (equal (ref "cs_item_sk") (ref "cr_item_sk")))) (table "catalog_sales") (table "catalog_returns")) (table "warehouse")) (table "item")) (table "date_dim"))) (where (and (and (and (and (isBetween (ref "i_current_price") 0.990000 1.490000) (equal (ref "i_item_sk") (ref "cs_item_sk"))) (equal (ref "cs_warehouse_sk") (ref "w_warehouse_sk"))) (equal (ref "cs_sold_date_sk") (ref "d_date_sk"))) (isBetween (ref "d_date") (subtract (cast (as "DATE") "1998-04-08") (interval "30" (day))) (add (cast (as "DATE") "1998-04-08") (interval "30" (day)))))) (groupBy (ref "w_state") (ref "i_item_id")) (orderBy (ascending (ref "w_state")) (ascending (ref "i_item_id")))))
