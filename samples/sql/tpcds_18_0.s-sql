(statements (query (select (ref "i_item_id") (ref "ca_country") (ref "ca_state") (ref "ca_county") (as "agg1") (function "avg" (cast (as "DECIMAL(12,2)") (ref "cs_quantity"))) (as "agg2") (function "avg" (cast (as "DECIMAL(12,2)") (ref "cs_list_price"))) (as "agg3") (function "avg" (cast (as "DECIMAL(12,2)") (ref "cs_coupon_amt"))) (as "agg4") (function "avg" (cast (as "DECIMAL(12,2)") (ref "cs_sales_price"))) (as "agg5") (function "avg" (cast (as "DECIMAL(12,2)") (ref "cs_net_profit"))) (as "agg6") (function "avg" (cast (as "DECIMAL(12,2)") (ref "c_birth_year"))) (as "agg7") (function "avg" (cast (as "DECIMAL(12,2)") (deref "cd_dep_count" (ref "cd1"))))) (from (join (join (join (join (join (join (table "catalog_sales") (aliasAs "cd1" (table "customer_demographics"))) (aliasAs "cd2" (table "customer_demographics"))) (table "customer")) (table "customer_address")) (table "date_dim")) (table "item"))) (where (and (and (and (and (and (and (and (and (and (and (equal (ref "cs_sold_date_sk") (ref "d_date_sk")) (equal (ref "cs_item_sk") (ref "i_item_sk"))) (equal (ref "cs_bill_cdemo_sk") (deref "cd_demo_sk" (ref "cd1")))) (equal (ref "cs_bill_customer_sk") (ref "c_customer_sk"))) (equal (deref "cd_gender" (ref "cd1")) "M")) (equal (deref "cd_education_status" (ref "cd1")) "College")) (equal (ref "c_current_cdemo_sk") (deref "cd_demo_sk" (ref "cd2")))) (equal (ref "c_current_addr_sk") (ref "ca_address_sk"))) (isIn (ref "c_birth_month") (list 9 5 12 4 1 10))) (equal (ref "d_year") 2001)) (isIn (ref "ca_state") (list "ND" "WI" "AL" "NC" "OK" "MS" "TN")))) (groupBy (rollup "i_item_id" "ca_country" "ca_state" "ca_county")) (orderBy (ascending (ref "ca_country")) (ascending (ref "ca_state")) (ascending (ref "ca_county")) (ascending (ref "i_item_id")))))
