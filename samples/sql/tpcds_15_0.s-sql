(statements (query (select (ref "ca_zip") (function "sum" (ref "cs_sales_price"))) (from (join (join (join (table "catalog_sales") (table "customer")) (table "customer_address")) (table "date_dim"))) (where (and (and (and (and (and (equal (ref "cs_bill_customer_sk") (ref "c_customer_sk")) (equal (ref "c_current_addr_sk") (ref "ca_address_sk"))) (or (or (isIn (function "substr" (ref "ca_zip") 1 5) (list "85669" "86197" "88274" "83405" "86475" "85392" "85460" "80348" "81792")) (isIn (ref "ca_state") (list "CA" "WA" "GA"))) (greater_than (ref "cs_sales_price") 500))) (equal (ref "cs_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_qoy") 2)) (equal (ref "d_year") 2000))) (groupBy (ref "ca_zip")) (orderBy (ascending (ref "ca_zip")))))
