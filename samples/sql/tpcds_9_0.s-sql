(statements (query (select (as "bucket1") (cases (case (when (greater_than (query (select (function "count")) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 1 20))) 25437)) (then (query (select (function "avg" (ref "ss_ext_discount_amt"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 1 20))))) (default (query (select (function "avg" (ref "ss_net_profit"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 1 20))))) (as "bucket2") (cases (case (when (greater_than (query (select (function "count")) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 21 40))) 22746)) (then (query (select (function "avg" (ref "ss_ext_discount_amt"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 21 40))))) (default (query (select (function "avg" (ref "ss_net_profit"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 21 40))))) (as "bucket3") (cases (case (when (greater_than (query (select (function "count")) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 41 60))) 9387)) (then (query (select (function "avg" (ref "ss_ext_discount_amt"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 41 60))))) (default (query (select (function "avg" (ref "ss_net_profit"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 41 60))))) (as "bucket4") (cases (case (when (greater_than (query (select (function "count")) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 61 80))) 10098)) (then (query (select (function "avg" (ref "ss_ext_discount_amt"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 61 80))))) (default (query (select (function "avg" (ref "ss_net_profit"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 61 80))))) (as "bucket5") (cases (case (when (greater_than (query (select (function "count")) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 81 100))) 18213)) (then (query (select (function "avg" (ref "ss_ext_discount_amt"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 81 100))))) (default (query (select (function "avg" (ref "ss_net_profit"))) (from (table "store_sales")) (where (isBetween (ref "ss_quantity") 81 100)))))) (from (table "reason")) (where (equal (ref "r_reason_sk") 1))))
