(statements (query (select (ref "ca_state") (ref "cd_gender") (ref "cd_marital_status") (ref "cd_dep_count") (as "cnt1") (function "count") (function "avg" (ref "cd_dep_count")) (function "max" (ref "cd_dep_count")) (function "sum" (ref "cd_dep_count")) (ref "cd_dep_employed_count") (as "cnt2") (function "count") (function "avg" (ref "cd_dep_employed_count")) (function "max" (ref "cd_dep_employed_count")) (function "sum" (ref "cd_dep_employed_count")) (ref "cd_dep_college_count") (as "cnt3") (function "count") (function "avg" (ref "cd_dep_college_count")) (function "max" (ref "cd_dep_college_count")) (function "sum" (ref "cd_dep_college_count"))) (from (join (join (aliasAs "c" (table "customer")) (aliasAs "ca" (table "customer_address"))) (table "customer_demographics"))) (where (and (and (and (equal (deref "c_current_addr_sk" (ref "c")) (deref "ca_address_sk" (ref "ca"))) (equal (ref "cd_demo_sk") (deref "c_current_cdemo_sk" (ref "c")))) (exists (query (select (all)) (from (join (table "store_sales") (table "date_dim"))) (where (and (and (and (equal (deref "c_customer_sk" (ref "c")) (ref "ss_customer_sk")) (equal (ref "ss_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1999)) (less_than (ref "d_qoy") 4)))))) (or (exists (query (select (all)) (from (join (table "web_sales") (table "date_dim"))) (where (and (and (and (equal (deref "c_customer_sk" (ref "c")) (ref "ws_bill_customer_sk")) (equal (ref "ws_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1999)) (less_than (ref "d_qoy") 4))))) (exists (query (select (all)) (from (join (table "catalog_sales") (table "date_dim"))) (where (and (and (and (equal (deref "c_customer_sk" (ref "c")) (ref "cs_ship_customer_sk")) (equal (ref "cs_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1999)) (less_than (ref "d_qoy") 4)))))))) (groupBy (ref "ca_state") (ref "cd_gender") (ref "cd_marital_status") (ref "cd_dep_count") (ref "cd_dep_employed_count") (ref "cd_dep_college_count")) (orderBy (ascending (ref "ca_state")) (ascending (ref "cd_gender")) (ascending (ref "cd_marital_status")) (ascending (ref "cd_dep_count")) (ascending (ref "cd_dep_employed_count")) (ascending (ref "cd_dep_college_count")))))
