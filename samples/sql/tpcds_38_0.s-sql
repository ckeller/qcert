(statements (query (select (function "count")) (from (aliasAs "hot_cust" (query (intersect (distinct) (intersect (distinct) (query (select (ref "c_last_name") (ref "c_first_name") (ref "d_date")) (from (join (join (table "store_sales") (table "date_dim")) (table "customer"))) (where (and (and (equal (deref "ss_sold_date_sk" (ref "store_sales")) (deref "d_date_sk" (ref "date_dim"))) (equal (deref "ss_customer_sk" (ref "store_sales")) (deref "c_customer_sk" (ref "customer")))) (isBetween (ref "d_month_seq") 1212 (add 1212 11))))) (query (select (ref "c_last_name") (ref "c_first_name") (ref "d_date")) (from (join (join (table "catalog_sales") (table "date_dim")) (table "customer"))) (where (and (and (equal (deref "cs_sold_date_sk" (ref "catalog_sales")) (deref "d_date_sk" (ref "date_dim"))) (equal (deref "cs_bill_customer_sk" (ref "catalog_sales")) (deref "c_customer_sk" (ref "customer")))) (isBetween (ref "d_month_seq") 1212 (add 1212 11)))))) (query (select (ref "c_last_name") (ref "c_first_name") (ref "d_date")) (from (join (join (table "web_sales") (table "date_dim")) (table "customer"))) (where (and (and (equal (deref "ws_sold_date_sk" (ref "web_sales")) (deref "d_date_sk" (ref "date_dim"))) (equal (deref "ws_bill_customer_sk" (ref "web_sales")) (deref "c_customer_sk" (ref "customer")))) (isBetween (ref "d_month_seq") 1212 (add 1212 11)))))))))))
