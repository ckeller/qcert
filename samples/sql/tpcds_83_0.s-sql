(statements (query (with (as "sr_items") (query (select (as "item_id") (ref "i_item_id") (as "sr_item_qty") (function "sum" (ref "sr_return_quantity"))) (from (join (join (table "store_returns") (table "item")) (table "date_dim"))) (where (and (and (equal (ref "sr_item_sk") (ref "i_item_sk")) (isIn (ref "d_date") (query (select (ref "d_date")) (from (table "date_dim")) (where (isIn (ref "d_week_seq") (query (select (ref "d_week_seq")) (from (table "date_dim")) (where (isIn (ref "d_date") (list "1998-01-02" "1998-10-15" "1998-11-10"))))))))) (equal (ref "sr_returned_date_sk") (ref "d_date_sk")))) (groupBy (ref "i_item_id")))) (with (as "cr_items") (query (select (as "item_id") (ref "i_item_id") (as "cr_item_qty") (function "sum" (ref "cr_return_quantity"))) (from (join (join (table "catalog_returns") (table "item")) (table "date_dim"))) (where (and (and (equal (ref "cr_item_sk") (ref "i_item_sk")) (isIn (ref "d_date") (query (select (ref "d_date")) (from (table "date_dim")) (where (isIn (ref "d_week_seq") (query (select (ref "d_week_seq")) (from (table "date_dim")) (where (isIn (ref "d_date") (list "1998-01-02" "1998-10-15" "1998-11-10"))))))))) (equal (ref "cr_returned_date_sk") (ref "d_date_sk")))) (groupBy (ref "i_item_id")))) (with (as "wr_items") (query (select (as "item_id") (ref "i_item_id") (as "wr_item_qty") (function "sum" (ref "wr_return_quantity"))) (from (join (join (table "web_returns") (table "item")) (table "date_dim"))) (where (and (and (equal (ref "wr_item_sk") (ref "i_item_sk")) (isIn (ref "d_date") (query (select (ref "d_date")) (from (table "date_dim")) (where (isIn (ref "d_week_seq") (query (select (ref "d_week_seq")) (from (table "date_dim")) (where (isIn (ref "d_date") (list "1998-01-02" "1998-10-15" "1998-11-10"))))))))) (equal (ref "wr_returned_date_sk") (ref "d_date_sk")))) (groupBy (ref "i_item_id")))) (select (deref "item_id" (ref "sr_items")) (ref "sr_item_qty") (as "sr_dev") (multiply (divide (divide (ref "sr_item_qty") (add (add (ref "sr_item_qty") (ref "cr_item_qty")) (ref "wr_item_qty"))) 3) 100) (ref "cr_item_qty") (as "cr_dev") (multiply (divide (divide (ref "cr_item_qty") (add (add (ref "sr_item_qty") (ref "cr_item_qty")) (ref "wr_item_qty"))) 3) 100) (ref "wr_item_qty") (as "wr_dev") (multiply (divide (divide (ref "wr_item_qty") (add (add (ref "sr_item_qty") (ref "cr_item_qty")) (ref "wr_item_qty"))) 3) 100) (as "average") (divide (add (add (ref "sr_item_qty") (ref "cr_item_qty")) (ref "wr_item_qty")) 3)) (from (join (join (table "sr_items") (table "cr_items")) (table "wr_items"))) (where (and (equal (deref "item_id" (ref "sr_items")) (deref "item_id" (ref "cr_items"))) (equal (deref "item_id" (ref "sr_items")) (deref "item_id" (ref "wr_items"))))) (orderBy (ascending (deref "item_id" (ref "sr_items"))) (ascending (ref "sr_item_qty")))))
