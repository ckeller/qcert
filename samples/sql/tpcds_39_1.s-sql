(statements (query (with (as "inv") (query (select (ref "w_warehouse_name") (ref "w_warehouse_sk") (ref "i_item_sk") (ref "d_moy") (ref "stdev") (ref "mean") (as "cov") (cases (operand (ref "mean")) (case (when 0) (then (dunit))) (default (divide (ref "stdev") (ref "mean"))))) (from (aliasAs "foo" (query (select (ref "w_warehouse_name") (ref "w_warehouse_sk") (ref "i_item_sk") (ref "d_moy") (as "stdev") (function "stddev_samp" (ref "inv_quantity_on_hand")) (as "mean") (function "avg" (ref "inv_quantity_on_hand"))) (from (join (join (join (table "inventory") (table "item")) (table "warehouse")) (table "date_dim"))) (where (and (and (and (equal (ref "inv_item_sk") (ref "i_item_sk")) (equal (ref "inv_warehouse_sk") (ref "w_warehouse_sk"))) (equal (ref "inv_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1998))) (groupBy (ref "w_warehouse_name") (ref "w_warehouse_sk") (ref "i_item_sk") (ref "d_moy"))))) (where (greater_than (cases (operand (ref "mean")) (case (when 0) (then 0)) (default (divide (ref "stdev") (ref "mean")))) 1)))) (select (deref "w_warehouse_sk" (ref "inv1")) (deref "i_item_sk" (ref "inv1")) (deref "d_moy" (ref "inv1")) (deref "mean" (ref "inv1")) (deref "cov" (ref "inv1")) (deref "w_warehouse_sk" (ref "inv2")) (deref "i_item_sk" (ref "inv2")) (deref "d_moy" (ref "inv2")) (deref "mean" (ref "inv2")) (deref "cov" (ref "inv2"))) (from (join (aliasAs "inv1" (table "inv")) (aliasAs "inv2" (table "inv")))) (where (and (and (and (and (equal (deref "i_item_sk" (ref "inv1")) (deref "i_item_sk" (ref "inv2"))) (equal (deref "w_warehouse_sk" (ref "inv1")) (deref "w_warehouse_sk" (ref "inv2")))) (equal (deref "d_moy" (ref "inv1")) 4)) (equal (deref "d_moy" (ref "inv2")) (add 4 1))) (greater_than (deref "cov" (ref "inv1")) 1.500000))) (orderBy (ascending (deref "w_warehouse_sk" (ref "inv1"))) (ascending (deref "i_item_sk" (ref "inv1"))) (ascending (deref "d_moy" (ref "inv1"))) (ascending (deref "mean" (ref "inv1"))) (ascending (deref "cov" (ref "inv1"))) (ascending (deref "d_moy" (ref "inv2"))) (ascending (deref "mean" (ref "inv2"))) (ascending (deref "cov" (ref "inv2"))))))
