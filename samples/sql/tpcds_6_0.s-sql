(statements (query (select (as "state") (deref "ca_state" (ref "a")) (as "cnt") (function "count")) (from (join (join (join (join (aliasAs "a" (table "customer_address")) (aliasAs "c" (table "customer"))) (aliasAs "s" (table "store_sales"))) (aliasAs "d" (table "date_dim"))) (aliasAs "i" (table "item")))) (where (and (and (and (and (and (equal (deref "ca_address_sk" (ref "a")) (deref "c_current_addr_sk" (ref "c"))) (equal (deref "c_customer_sk" (ref "c")) (deref "ss_customer_sk" (ref "s")))) (equal (deref "ss_sold_date_sk" (ref "s")) (deref "d_date_sk" (ref "d")))) (equal (deref "ss_item_sk" (ref "s")) (deref "i_item_sk" (ref "i")))) (equal (deref "d_month_seq" (ref "d")) (query (select (ref "d_month_seq")) (from (table "date_dim")) (where (and (equal (ref "d_year") 2000) (equal (ref "d_moy") 2)))))) (greater_than (deref "i_current_price" (ref "i")) (multiply 1.200000 (query (select (function "avg" (deref "i_current_price" (ref "j")))) (from (aliasAs "j" (table "item"))) (where (equal (deref "i_category" (ref "j")) (deref "i_category" (ref "i"))))))))) (groupBy (deref "ca_state" (ref "a"))) (having (greater_than_or_equal (function "count") 10)) (orderBy (ascending (ref "cnt")))))
