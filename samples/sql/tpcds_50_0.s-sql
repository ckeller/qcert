(statements (query (select (ref "s_store_name") (ref "s_company_id") (ref "s_street_number") (ref "s_street_name") (ref "s_street_type") (ref "s_suite_number") (ref "s_city") (ref "s_county") (ref "s_state") (ref "s_zip") (as "30 days") (function "sum" (cases (case (when (less_than_or_equal (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 30)) (then 1)) (default 0))) (as "31-60 days") (function "sum" (cases (case (when (and (greater_than (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 30) (less_than_or_equal (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 60))) (then 1)) (default 0))) (as "61-90 days") (function "sum" (cases (case (when (and (greater_than (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 60) (less_than_or_equal (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 90))) (then 1)) (default 0))) (as "91-120 days") (function "sum" (cases (case (when (and (greater_than (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 90) (less_than_or_equal (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 120))) (then 1)) (default 0))) (as ">120 days") (function "sum" (cases (case (when (greater_than (subtract (ref "sr_returned_date_sk") (ref "ss_sold_date_sk")) 120)) (then 1)) (default 0)))) (from (join (join (join (join (table "store_sales") (table "store_returns")) (table "store")) (aliasAs "d1" (table "date_dim"))) (aliasAs "d2" (table "date_dim")))) (where (and (and (and (and (and (and (and (equal (deref "d_year" (ref "d2")) 2000) (equal (deref "d_moy" (ref "d2")) 9)) (equal (ref "ss_ticket_number") (ref "sr_ticket_number"))) (equal (ref "ss_item_sk") (ref "sr_item_sk"))) (equal (ref "ss_sold_date_sk") (deref "d_date_sk" (ref "d1")))) (equal (ref "sr_returned_date_sk") (deref "d_date_sk" (ref "d2")))) (equal (ref "ss_customer_sk") (ref "sr_customer_sk"))) (equal (ref "ss_store_sk") (ref "s_store_sk")))) (groupBy (ref "s_store_name") (ref "s_company_id") (ref "s_street_number") (ref "s_street_name") (ref "s_street_type") (ref "s_suite_number") (ref "s_city") (ref "s_county") (ref "s_state") (ref "s_zip")) (orderBy (ascending (ref "s_store_name")) (ascending (ref "s_company_id")) (ascending (ref "s_street_number")) (ascending (ref "s_street_name")) (ascending (ref "s_street_type")) (ascending (ref "s_suite_number")) (ascending (ref "s_city")) (ascending (ref "s_county")) (ascending (ref "s_state")) (ascending (ref "s_zip")))))
