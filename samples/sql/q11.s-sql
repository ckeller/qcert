(query (select (ref "ps_partkey") (as "value") (function "sum" (multiply (ref "ps_supplycost") (ref "ps_availqty")))) (from (join (join (table "partsupp") (table "supplier")) (table "nation"))) (where (and (and (equal (ref "ps_suppkey") (ref "s_suppkey")) (equal (ref "s_nationkey") (ref "n_nationkey"))) (equal (ref "n_name") "GERMANY"))) (groupBy (ref "ps_partkey")) (having (greater_than (function "sum" (multiply (ref "ps_supplycost") (ref "ps_availqty"))) (query (select (multiply (function "sum" (multiply (ref "ps_supplycost") (ref "ps_availqty"))) 0.000100)) (from (join (join (table "partsupp") (table "supplier")) (table "nation"))) (where (and (and (equal (ref "ps_suppkey") (ref "s_suppkey")) (equal (ref "s_nationkey") (ref "n_nationkey"))) (equal (ref "n_name") "GERMANY")))))) (orderBy (descending (ref "value"))))
