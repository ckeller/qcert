(statements (query (select (function "sum" (ref "ss_quantity"))) (from (join (join (join (join (table "store_sales") (table "store")) (table "customer_demographics")) (table "customer_address")) (table "date_dim"))) (where (and (and (and (and (equal (ref "s_store_sk") (ref "ss_store_sk")) (equal (ref "ss_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1998)) (or (or (and (and (and (equal (ref "cd_demo_sk") (ref "ss_cdemo_sk")) (equal (ref "cd_marital_status") "M")) (equal (ref "cd_education_status") "4 yr Degree")) (isBetween (ref "ss_sales_price") 100 150)) (and (and (and (equal (ref "cd_demo_sk") (ref "ss_cdemo_sk")) (equal (ref "cd_marital_status") "D")) (equal (ref "cd_education_status") "Primary")) (isBetween (ref "ss_sales_price") 50 100))) (and (and (and (equal (ref "cd_demo_sk") (ref "ss_cdemo_sk")) (equal (ref "cd_marital_status") "U")) (equal (ref "cd_education_status") "Advanced Degree")) (isBetween (ref "ss_sales_price") 150 200)))) (or (or (and (and (and (equal (ref "ss_addr_sk") (ref "ca_address_sk")) (equal (ref "ca_country") "United States")) (isIn (ref "ca_state") (list "KY" "GA" "NM"))) (isBetween (ref "ss_net_profit") 0 2000)) (and (and (and (equal (ref "ss_addr_sk") (ref "ca_address_sk")) (equal (ref "ca_country") "United States")) (isIn (ref "ca_state") (list "MT" "OR" "IN"))) (isBetween (ref "ss_net_profit") 150 3000))) (and (and (and (equal (ref "ss_addr_sk") (ref "ca_address_sk")) (equal (ref "ca_country") "United States")) (isIn (ref "ca_state") (list "WI" "MO" "WV"))) (isBetween (ref "ss_net_profit") 50 25000)))))))
