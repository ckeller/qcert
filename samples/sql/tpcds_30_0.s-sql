(statements (query (with (as "customer_total_return") (query (select (as "ctr_customer_sk") (ref "wr_returning_customer_sk") (as "ctr_state") (ref "ca_state") (as "ctr_total_return") (function "sum" (ref "wr_return_amt"))) (from (join (join (table "web_returns") (table "date_dim")) (table "customer_address"))) (where (and (and (equal (ref "wr_returned_date_sk") (ref "d_date_sk")) (equal (ref "d_year") 2002)) (equal (ref "wr_returning_addr_sk") (ref "ca_address_sk")))) (groupBy (ref "wr_returning_customer_sk") (ref "ca_state")))) (select (ref "c_customer_id") (ref "c_salutation") (ref "c_first_name") (ref "c_last_name") (ref "c_preferred_cust_flag") (ref "c_birth_day") (ref "c_birth_month") (ref "c_birth_year") (ref "c_birth_country") (ref "c_login") (ref "c_email_address") (ref "c_last_review_date") (ref "ctr_total_return")) (from (join (join (aliasAs "ctr1" (table "customer_total_return")) (table "customer_address")) (table "customer"))) (where (and (and (and (greater_than (deref "ctr_total_return" (ref "ctr1")) (query (select (multiply (function "avg" (ref "ctr_total_return")) 1.200000)) (from (aliasAs "ctr2" (table "customer_total_return"))) (where (equal (deref "ctr_state" (ref "ctr1")) (deref "ctr_state" (ref "ctr2")))))) (equal (ref "ca_address_sk") (ref "c_current_addr_sk"))) (equal (ref "ca_state") "IL")) (equal (deref "ctr_customer_sk" (ref "ctr1")) (ref "c_customer_sk")))) (orderBy (ascending (ref "c_customer_id")) (ascending (ref "c_salutation")) (ascending (ref "c_first_name")) (ascending (ref "c_last_name")) (ascending (ref "c_preferred_cust_flag")) (ascending (ref "c_birth_day")) (ascending (ref "c_birth_month")) (ascending (ref "c_birth_year")) (ascending (ref "c_birth_country")) (ascending (ref "c_login")) (ascending (ref "c_email_address")) (ascending (ref "c_last_review_date")) (ascending (ref "ctr_total_return")))))
