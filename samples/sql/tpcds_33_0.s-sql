(statements (query (with (as "ss") (query (select (ref "i_manufact_id") (as "total_sales") (function "sum" (ref "ss_ext_sales_price"))) (from (join (join (join (table "store_sales") (table "date_dim")) (table "customer_address")) (table "item"))) (where (and (and (and (and (and (and (isIn (ref "i_manufact_id") (query (select (ref "i_manufact_id")) (from (table "item")) (where (isIn (ref "i_category") (list "Books"))))) (equal (ref "ss_item_sk") (ref "i_item_sk"))) (equal (ref "ss_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1999)) (equal (ref "d_moy") 3)) (equal (ref "ss_addr_sk") (ref "ca_address_sk"))) (equal (ref "ca_gmt_offset") (minus 5)))) (groupBy (ref "i_manufact_id")))) (with (as "cs") (query (select (ref "i_manufact_id") (as "total_sales") (function "sum" (ref "cs_ext_sales_price"))) (from (join (join (join (table "catalog_sales") (table "date_dim")) (table "customer_address")) (table "item"))) (where (and (and (and (and (and (and (isIn (ref "i_manufact_id") (query (select (ref "i_manufact_id")) (from (table "item")) (where (isIn (ref "i_category") (list "Books"))))) (equal (ref "cs_item_sk") (ref "i_item_sk"))) (equal (ref "cs_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1999)) (equal (ref "d_moy") 3)) (equal (ref "cs_bill_addr_sk") (ref "ca_address_sk"))) (equal (ref "ca_gmt_offset") (minus 5)))) (groupBy (ref "i_manufact_id")))) (with (as "ws") (query (select (ref "i_manufact_id") (as "total_sales") (function "sum" (ref "ws_ext_sales_price"))) (from (join (join (join (table "web_sales") (table "date_dim")) (table "customer_address")) (table "item"))) (where (and (and (and (and (and (and (isIn (ref "i_manufact_id") (query (select (ref "i_manufact_id")) (from (table "item")) (where (isIn (ref "i_category") (list "Books"))))) (equal (ref "ws_item_sk") (ref "i_item_sk"))) (equal (ref "ws_sold_date_sk") (ref "d_date_sk"))) (equal (ref "d_year") 1999)) (equal (ref "d_moy") 3)) (equal (ref "ws_bill_addr_sk") (ref "ca_address_sk"))) (equal (ref "ca_gmt_offset") (minus 5)))) (groupBy (ref "i_manufact_id")))) (select (ref "i_manufact_id") (as "total_sales") (function "sum" (ref "total_sales"))) (from (aliasAs "tmp1" (query (union (union (query (select (all)) (from (table "ss"))) (query (select (all)) (from (table "cs")))) (query (select (all)) (from (table "ws"))))))) (groupBy (ref "i_manufact_id")) (orderBy (ascending (ref "total_sales")))))
