(statements (query (select (as "am_pm_ratio") (divide (cast (as "DECIMAL(15,4)") (ref "amc")) (cast (as "DECIMAL(15,4)") (ref "pmc")))) (from (join (aliasAs "at" (query (select (as "amc") (function "count")) (from (join (join (join (table "web_sales") (table "household_demographics")) (table "time_dim")) (table "web_page"))) (where (and (and (and (and (and (equal (ref "ws_sold_time_sk") (deref "t_time_sk" (ref "time_dim"))) (equal (ref "ws_ship_hdemo_sk") (deref "hd_demo_sk" (ref "household_demographics")))) (equal (ref "ws_web_page_sk") (deref "wp_web_page_sk" (ref "web_page")))) (isBetween (deref "t_hour" (ref "time_dim")) 6 (add 6 1))) (equal (deref "hd_dep_count" (ref "household_demographics")) 8)) (isBetween (deref "wp_char_count" (ref "web_page")) 5000 5200))))) (aliasAs "pt" (query (select (as "pmc") (function "count")) (from (join (join (join (table "web_sales") (table "household_demographics")) (table "time_dim")) (table "web_page"))) (where (and (and (and (and (and (equal (ref "ws_sold_time_sk") (deref "t_time_sk" (ref "time_dim"))) (equal (ref "ws_ship_hdemo_sk") (deref "hd_demo_sk" (ref "household_demographics")))) (equal (ref "ws_web_page_sk") (deref "wp_web_page_sk" (ref "web_page")))) (isBetween (deref "t_hour" (ref "time_dim")) 14 (add 14 1))) (equal (deref "hd_dep_count" (ref "household_demographics")) 8)) (isBetween (deref "wp_char_count" (ref "web_page")) 5000 5200))))))) (orderBy (ascending (ref "am_pm_ratio")))))
