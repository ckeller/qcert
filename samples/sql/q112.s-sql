(query (select (ref "l_shipmode" ) (as "high_line_count") (function "sum" (cases (case (when (or (equal (ref "o_orderpriority" ) "1-URGENT" ) (equal (ref "o_orderpriority" ) "2-HIGH" ) ) ) (then 1 )) (default 0 )) ) (as "low_line_count") (function "sum" (cases (case (when (and (not_equal (ref "o_orderpriority" ) "1-URGENT" ) (not_equal (ref "o_orderpriority" ) "2-HIGH" ) ) ) (then 1 )) (default 0 )) ) ) (from (join (table "orders" ) (table "lineitem" ) ) ) (where (and (and (and (and (and (equal (ref "o_orderkey" ) (ref "l_orderkey" ) ) (isIn (ref "l_shipmode" ) (list "MAIL" "SHIP" ) ) ) (function "date_lt" (ref "l_commitdate" ) (ref "l_receiptdate" ) ) ) (function "date_lt" (ref "l_shipdate" ) (ref "l_commitdate" ) ) ) (function "date_gt" (ref "l_receiptdate" ) (literal "date" "1994-01-01" )) ) (function "date_lt" (ref "l_receiptdate" ) (function "date_plus" (literal "date" "1994-01-01" )(interval "1" (year))) ) ) ) (groupBy (ref "l_shipmode" ) ) (orderBy (ascending (ref "l_shipmode" ) ) ) ) 
