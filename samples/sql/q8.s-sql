(statements (query (select (ref "o_year" ) (as "mkt_share") (divide (function "sum" (cases (case (when (equal (ref "nation" ) "BRAZIL" ) ) (then (ref "volume" ) )) (default 0 )) ) (function "sum" (ref "volume" ) ) ) ) (from (aliasAs "all_nations" (query (select (as "o_year") (extract (year) (ref "o_orderdate" ) ) (as "volume") (multiply (ref "l_extendedprice" ) (subtract 1 (ref "l_discount" ) ) ) (as "nation") (deref "n_name" (ref "n2" ) ) ) (from (join (join (join (join (join (join (join (table "part" ) (table "supplier" ) ) (table "lineitem" ) ) (table "orders" ) ) (table "customer" ) ) (aliasAs "n1" (table "nation" ) ) ) (aliasAs "n2" (table "nation" ) ) ) (table "region" ) ) ) (where (and (and (and (and (and (and (and (and (and (equal (ref "p_partkey" ) (ref "l_partkey" ) ) (equal (ref "s_suppkey" ) (ref "l_suppkey" ) ) ) (equal (ref "l_orderkey" ) (ref "o_orderkey" ) ) ) (equal (ref "o_custkey" ) (ref "c_custkey" ) ) ) (equal (ref "c_nationkey" ) (deref "n_nationkey" (ref "n1" ) ) ) ) (equal (deref "n_regionkey" (ref "n1" ) ) (ref "r_regionkey" ) ) ) (equal (ref "r_name" ) "AMERICA" ) ) (equal (ref "s_nationkey" ) (deref "n_nationkey" (ref "n2" ) ) ) ) (isBetween (ref "o_orderdate" ) (literal "date" "1995-01-01" )(literal "date" "1996-12-31" )) ) (equal (ref "p_type" ) "ECONOMY ANODIZED STEEL" ) ) ) ) ) ) (groupBy (ref "o_year" ) ) (orderBy (ascending (ref "o_year" ) ) ) ) )
