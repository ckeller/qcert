(query (select (ref "cntrycode" ) (as "numcust") (function "count" ) (as "totacctbal") (function "sum" (ref "c_acctbal" ) ) ) (from (aliasAs "custsale" (query (select (as "cntrycode") (function "substr" (ref "c_phone" ) 1 2 ) (ref "c_acctbal" ) ) (from (table "customer" ) ) (where (and (and (isIn (function "substr" (ref "c_phone" ) 1 2 ) (list "13" "31" "23" "29" "30" "18" "17" ) ) (greater_than (ref "c_acctbal" ) (query (select (function "avg" (ref "c_acctbal" ) ) ) (from (table "customer" ) ) (where (and (greater_than (ref "c_acctbal" ) 0.000000 ) (isIn (function "substr" (ref "c_phone" ) 1 2 ) (list "13" "31" "23" "29" "30" "18" "17" ) ) ) ) ) ) ) (not (exists (query (select (all ) ) (from (table "orders" ) ) (where (equal (ref "o_custkey" ) (ref "c_custkey" ) ) ) ) ) ) ) ) ) ) ) (groupBy (ref "cntrycode" ) ) (orderBy (ascending (ref "cntrycode" ) ) ) ) 
