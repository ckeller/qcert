(statements (createView "revenue0" (query (select (as "supplier_no") (ref "l_suppkey" ) (as "total_revenue") (function "sum" (multiply (ref "l_extendedprice" ) (subtract 1 (ref "l_discount" ) ) ) ) ) (from (table "lineitem" ) ) (where (and (function "date_ge" (ref "l_shipdate" ) (literal "date" "1996-01-01" )) (function "date_lt" (ref "l_shipdate" ) (function "date_plus" (literal "date" "1996-01-01" )(interval "3" (month))) ) ) ) (groupBy (ref "l_suppkey" ) ) ) ) (query (select (ref "s_suppkey" ) (ref "s_name" ) (ref "s_address" ) (ref "s_phone" ) (ref "total_revenue" ) ) (from (join (table "supplier" ) (table "revenue0" ) ) ) (where (and (equal (ref "s_suppkey" ) (ref "supplier_no" ) ) (equal (ref "total_revenue" ) (query (select (function "max" (ref "total_revenue" ) ) ) (from (table "revenue0" ) ) ) ) ) ) (orderBy (ascending (ref "s_suppkey" ) ) ) ) (dropView "revenue0") )
