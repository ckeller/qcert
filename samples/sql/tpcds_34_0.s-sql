(statements (query (select (ref "c_last_name") (ref "c_first_name") (ref "c_salutation") (ref "c_preferred_cust_flag") (ref "ss_ticket_number") (ref "cnt")) (from (join (aliasAs "dn" (query (select (ref "ss_ticket_number") (ref "ss_customer_sk") (as "cnt") (function "count")) (from (join (join (join (table "store_sales") (table "date_dim")) (table "store")) (table "household_demographics"))) (where (and (and (and (and (and (and (and (and (equal (deref "ss_sold_date_sk" (ref "store_sales")) (deref "d_date_sk" (ref "date_dim"))) (equal (deref "ss_store_sk" (ref "store_sales")) (deref "s_store_sk" (ref "store")))) (equal (deref "ss_hdemo_sk" (ref "store_sales")) (deref "hd_demo_sk" (ref "household_demographics")))) (or (isBetween (deref "d_dom" (ref "date_dim")) 1 3) (isBetween (deref "d_dom" (ref "date_dim")) 25 28))) (or (equal (deref "hd_buy_potential" (ref "household_demographics")) ">10000") (equal (deref "hd_buy_potential" (ref "household_demographics")) "Unknown"))) (greater_than (deref "hd_vehicle_count" (ref "household_demographics")) 0)) (greater_than (cases (case (when (greater_than (deref "hd_vehicle_count" (ref "household_demographics")) 0)) (then (divide (deref "hd_dep_count" (ref "household_demographics")) (deref "hd_vehicle_count" (ref "household_demographics"))))) (default (dunit))) 1.200000)) (isIn (deref "d_year" (ref "date_dim")) (list 1998 (add 1998 1) (add 1998 2)))) (isIn (deref "s_county" (ref "store")) (list "Williamson County" "Williamson County" "Williamson County" "Williamson County" "Williamson County" "Williamson County" "Williamson County" "Williamson County")))) (groupBy (ref "ss_ticket_number") (ref "ss_customer_sk")))) (table "customer"))) (where (and (equal (ref "ss_customer_sk") (ref "c_customer_sk")) (isBetween (ref "cnt") 15 20))) (orderBy (ascending (ref "c_last_name")) (ascending (ref "c_first_name")) (ascending (ref "c_salutation")) (descending (ref "c_preferred_cust_flag")))))
