(statements (query (select (ref "i_item_id") (ref "i_item_desc") (ref "i_category") (ref "i_class") (ref "i_current_price") (as "itemrevenue") (function "sum" (ref "cs_ext_sales_price")) (as "revenueratio") (divide (multiply (function "sum" (ref "cs_ext_sales_price")) 100) (function (partitionBy (ref "i_class")) "sum" (function "sum" (ref "cs_ext_sales_price"))))) (from (join (join (table "catalog_sales") (table "item")) (table "date_dim"))) (where (and (and (and (equal (ref "cs_item_sk") (ref "i_item_sk")) (isIn (ref "i_category") (list "Jewelry" "Sports" "Books"))) (equal (ref "cs_sold_date_sk") (ref "d_date_sk"))) (isBetween (ref "d_date") (cast (as "DATE") "2001-01-12") (add (cast (as "DATE") "2001-01-12") (interval "30" (day)))))) (groupBy (ref "i_item_id") (ref "i_item_desc") (ref "i_category") (ref "i_class") (ref "i_current_price")) (orderBy (ascending (ref "i_category")) (ascending (ref "i_class")) (ascending (ref "i_item_id")) (ascending (ref "i_item_desc")) (ascending (ref "revenueratio")))))
