(query (select (ref "s_name" ) (as "numwait") (function "count" ) ) (from (join (join (join (table "supplier" ) (aliasAs "l1" (table "lineitem" ) ) ) (table "orders" ) ) (table "nation" ) ) ) (where (and (and (and (and (and (and (and (equal (ref "s_suppkey" ) (deref "l_suppkey" (ref "l1" ) ) ) (equal (ref "o_orderkey" ) (deref "l_orderkey" (ref "l1" ) ) ) ) (equal (ref "o_orderstatus" ) "F" ) ) (function "date_gt" (deref "l_receiptdate" (ref "l1" ) ) (deref "l_commitdate" (ref "l1" ) ) ) ) (exists (query (select (all ) ) (from (aliasAs "l2" (table "lineitem" ) ) ) (where (and (equal (deref "l_orderkey" (ref "l2" ) ) (deref "l_orderkey" (ref "l1" ) ) ) (not_equal (deref "l_suppkey" (ref "l2" ) ) (deref "l_suppkey" (ref "l1" ) ) ) ) ) ) ) ) (not (exists (query (select (all ) ) (from (aliasAs "l3" (table "lineitem" ) ) ) (where (and (and (equal (deref "l_orderkey" (ref "l3" ) ) (deref "l_orderkey" (ref "l1" ) ) ) (not_equal (deref "l_suppkey" (ref "l3" ) ) (deref "l_suppkey" (ref "l1" ) ) ) ) (function "date_lt" (deref "l_receiptdate" (ref "l3" ) ) (deref "l_commitdate" (ref "l3" ) ) ) ) ) ) ) ) ) (equal (ref "s_nationkey" ) (ref "n_nationkey" ) ) ) (equal (ref "n_name" ) "SAUDI ARABIA" ) ) ) (groupBy (ref "s_name" ) ) (orderBy (descending (ref "numwait" ) ) (ascending (ref "s_name" ) ) ) ) 
