(query (select (ref "c_count" ) (as "custdist") (function "count" ) ) (from (aliasAs "c_orders" (query (select (ref "c_custkey" ) (function "count" (ref "o_orderkey" ) ) ) (from (join (left)(on (and (equal (ref "c_custkey" ) (ref "o_custkey" ) ) (not (like (ref "o_comment" ) "%special%requests%" ) ) ) ) (table "customer" ) (table "orders" ) ) ) (groupBy (ref "c_custkey" ) ) ) (columns "c_custkey" "c_count" )) ) (groupBy (ref "c_count" ) ) (orderBy (descending (ref "custdist" ) ) (descending (ref "c_count" ) ) ) ) 
